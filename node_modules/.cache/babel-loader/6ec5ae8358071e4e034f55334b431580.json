{"ast":null,"code":"import { useState, useEffect, useMemo } from 'react';\nimport { useMapContext } from '@uiw/react-baidu-map-map';\nimport { requireScript } from '@uiw/react-baidu-map-utils';\nimport { useEnableProperties, useProperties, useVisiable, useEventProperties } from '@uiw/react-baidu-map-utils';\nexport function useCurveLine(props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var {\n    strokeColor,\n    strokeWeight,\n    strokeOpacity,\n    strokeStyle,\n    enableMassClear,\n    enableEditing = false,\n    enableClicking,\n    icons\n  } = props;\n  var {\n    map\n  } = useMapContext();\n  var [curveLine, setCurveLine] = useState();\n  var libSDK = window.BMapLib;\n  var [bMapLib, setBMapLib] = useState(libSDK);\n  var [loadMapLib, setLoadBMapLib] = useState(false || !!libSDK); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  var opts = {\n    strokeColor,\n    strokeWeight,\n    strokeOpacity,\n    strokeStyle,\n    enableMassClear,\n    enableEditing,\n    enableClicking,\n    icons\n  };\n  useMemo(() => {\n    // 如果第一次加载，会执行下面的\n    if (map && bMapLib && !curveLine) {\n      if (bMapLib.CurveLine) {\n        var points = (props.path || []).map(item => new BMap.Point(item.lng, item.lat));\n        var instance = new BMapLib.CurveLine(points, opts);\n        map.addOverlay(instance);\n        setCurveLine(instance);\n      }\n    } // 如果 bMapLib 已经加载过，会执行下面的\n\n\n    if (map && bMapLib && !bMapLib.CurveLine) {\n      requireScript('//api.map.baidu.com/library/CurveLine/1.5/src/CurveLine.min.js').then(() => {\n        if (window.BMapLib) {\n          var newMapLib = Object.assign(window.BMapLib, bMapLib);\n          setBMapLib(newMapLib);\n\n          var _points = (props.path || []).map(item => new BMap.Point(item.lng, item.lat));\n\n          var _instance = new BMapLib.CurveLine(_points, opts);\n\n          map.addOverlay(_instance);\n          setCurveLine(_instance);\n        }\n      }).catch(() => {});\n    } // 如果第一次加载，会执行下面的\n\n\n    if (!bMapLib && !loadMapLib) {\n      setLoadBMapLib(true);\n      requireScript('//api.map.baidu.com/library/CurveLine/1.5/src/CurveLine.min.js').then(() => {\n        if (window.BMapLib) {\n          setBMapLib(window.BMapLib);\n        }\n      }).catch(() => {});\n    }\n  }, [map, bMapLib, curveLine, loadMapLib, props.path, opts]);\n  var [path, setPath] = useState(props.path || []);\n  useEffect(() => {\n    if (curveLine && props.path && path && JSON.stringify(path) !== JSON.stringify(props.path)) {\n      var points = path.map(item => new BMap.Point(item.lng, item.lat));\n      curveLine.setPath(points);\n    }\n  }, [curveLine, path, props.path]);\n  useVisiable(curveLine, props);\n  useEventProperties(curveLine, props, ['Click', 'DblClick', 'MouseDown', 'MouseUp', 'MouseOut', 'MouseOver', 'Remove', 'LineUpdate']);\n  useEnableProperties(curveLine, props, ['Editing', 'MassClear']); // PositionAt\n\n  useProperties(curveLine, props, ['StrokeColor', 'StrokeOpacity', 'StrokeWeight', 'StrokeStyle']);\n  return {\n    curveLine,\n    setCurveLine,\n    BMapLib: bMapLib,\n    path,\n    setPath\n  };\n}","map":{"version":3,"mappings":"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","names":["useState","useEffect","useMemo","useMapContext","requireScript","useEnableProperties","useProperties","useVisiable","useEventProperties","useCurveLine","props","strokeColor","strokeWeight","strokeOpacity","strokeStyle","enableMassClear","enableEditing","enableClicking","icons","map","curveLine","setCurveLine","libSDK","window","BMapLib","bMapLib","setBMapLib","loadMapLib","setLoadBMapLib","opts","CurveLine","points","path","item","BMap","Point","lng","lat","instance","addOverlay","then","newMapLib","Object","assign","catch","setPath","JSON","stringify"],"sources":["D:\\HB\\ReactProject\\22_3_8\\backboot\\node_modules\\@uiw\\react-baidu-map-curve-line\\src\\useCurveLine.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport { useMapContext } from '@uiw/react-baidu-map-map';\nimport { requireScript } from '@uiw/react-baidu-map-utils';\nimport { useEnableProperties, useProperties, useVisiable, useEventProperties } from '@uiw/react-baidu-map-utils';\nimport { CurveLineProps } from '.';\n\nexport interface UseCurveLine extends CurveLineProps {}\n\nexport function useCurveLine(props = {} as UseCurveLine) {\n  const {\n    strokeColor,\n    strokeWeight,\n    strokeOpacity,\n    strokeStyle,\n    enableMassClear,\n    enableEditing = false,\n    enableClicking,\n    icons,\n  } = props;\n  const { map } = useMapContext();\n  const [curveLine, setCurveLine] = useState<BMapLib.CurveLine>();\n  const libSDK = window.BMapLib;\n  const [bMapLib, setBMapLib] = useState<typeof BMapLib>(libSDK);\n  const [loadMapLib, setLoadBMapLib] = useState(false || !!libSDK);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const opts = {\n    strokeColor,\n    strokeWeight,\n    strokeOpacity,\n    strokeStyle,\n    enableMassClear,\n    enableEditing,\n    enableClicking,\n    icons,\n  };\n  useMemo(() => {\n    // 如果第一次加载，会执行下面的\n    if (map && bMapLib && !curveLine) {\n      if (bMapLib.CurveLine) {\n        const points = (props.path || []).map((item) => new BMap.Point(item.lng, item.lat));\n        const instance = new BMapLib.CurveLine(points, opts);\n        map.addOverlay(instance);\n        setCurveLine(instance);\n      }\n    }\n\n    // 如果 bMapLib 已经加载过，会执行下面的\n    if (map && bMapLib && !bMapLib.CurveLine) {\n      requireScript('//api.map.baidu.com/library/CurveLine/1.5/src/CurveLine.min.js')\n        .then(() => {\n          if (window.BMapLib) {\n            const newMapLib = Object.assign(window.BMapLib, bMapLib);\n            setBMapLib(newMapLib);\n\n            const points = (props.path || []).map((item) => new BMap.Point(item.lng, item.lat));\n            const instance = new BMapLib.CurveLine(points, opts);\n            map.addOverlay(instance);\n            setCurveLine(instance);\n          }\n        })\n        .catch(() => {});\n    }\n\n    // 如果第一次加载，会执行下面的\n    if (!bMapLib && !loadMapLib) {\n      setLoadBMapLib(true);\n      requireScript('//api.map.baidu.com/library/CurveLine/1.5/src/CurveLine.min.js')\n        .then(() => {\n          if (window.BMapLib) {\n            setBMapLib(window.BMapLib);\n          }\n        })\n        .catch(() => {});\n    }\n  }, [map, bMapLib, curveLine, loadMapLib, props.path, opts]);\n\n  const [path, setPath] = useState(props.path || []);\n  useEffect(() => {\n    if (curveLine && props.path && path && JSON.stringify(path) !== JSON.stringify(props.path)) {\n      const points = path.map((item) => new BMap.Point(item.lng, item.lat));\n      curveLine.setPath(points);\n    }\n  }, [curveLine, path, props.path]);\n\n  useVisiable(curveLine!, props);\n  useEventProperties<BMap.Polyline, UseCurveLine>(curveLine!, props, [\n    'Click',\n    'DblClick',\n    'MouseDown',\n    'MouseUp',\n    'MouseOut',\n    'MouseOver',\n    'Remove',\n    'LineUpdate',\n  ]);\n  useEnableProperties<BMapLib.CurveLine, UseCurveLine>(curveLine!, props, ['Editing', 'MassClear']);\n  // PositionAt\n  useProperties<BMapLib.CurveLine, UseCurveLine>(curveLine!, props, [\n    'StrokeColor',\n    'StrokeOpacity',\n    'StrokeWeight',\n    'StrokeStyle',\n  ]);\n\n  return {\n    curveLine,\n    setCurveLine,\n    BMapLib: bMapLib,\n    path,\n    setPath,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}