{"ast":null,"code":"import { useState, useMemo } from 'react';\nimport { useMapContext } from '@uiw/react-baidu-map-map';\nimport { requireScript, requireCss } from '@uiw/react-baidu-map-utils';\nexport function useDrawingManager(props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var {\n    isOpen,\n    drawingMode,\n    enableDrawingTool,\n    enableCalculate,\n    drawingToolOptions,\n    markerOptions,\n    circleOptions,\n    polylineOptions,\n    polygonOptions,\n    rectangleOptions\n  } = props;\n  var {\n    map\n  } = useMapContext();\n  var [drawingManager, setDrawingManager] = useState();\n  var libSDK = window.BMapLib;\n  var [bMapLib, setBMapLib] = useState(libSDK);\n  var [loadMapLib, setLoadBMapLib] = useState(false || !!libSDK);\n  var opts = {\n    isOpen,\n    drawingMode,\n    enableDrawingTool,\n    enableCalculate,\n    drawingToolOptions,\n    markerOptions,\n    circleOptions,\n    polylineOptions,\n    polygonOptions,\n    rectangleOptions\n  };\n  useMemo(() => {\n    // 如果第一次加载，会执行下面的\n    if (map && bMapLib && !drawingManager) {\n      if (bMapLib.DrawingManager) {\n        var instance = new BMapLib.DrawingManager(map, opts);\n        setDrawingManager(instance);\n      }\n    } // 如果 bMapLib 已经加载过，会执行下面的\n\n\n    if (map && bMapLib && !bMapLib.DrawingManager) {\n      requireCss('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css').then(() => {});\n      requireScript('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js').then(() => {\n        if (window.BMapLib) {\n          var newMapLib = Object.assign(window.BMapLib, bMapLib);\n          setBMapLib(newMapLib);\n\n          var _instance = new BMapLib.DrawingManager(map, opts);\n\n          setDrawingManager(_instance);\n        }\n      }).catch(() => {});\n    } // 如果第一次加载，会执行下面的\n\n\n    if (!bMapLib && !loadMapLib) {\n      setLoadBMapLib(true);\n      requireCss('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css').then(() => {});\n      requireScript('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js').then(() => {\n        if (window.BMapLib) {\n          setBMapLib(window.BMapLib);\n        }\n      }).catch(() => {});\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [map, loadMapLib, bMapLib, drawingManager]);\n  return {\n    drawingManager,\n    setDrawingManager,\n    BMapLib: bMapLib\n  };\n}","map":{"version":3,"mappings":"AAAA,SAASA,QAAT,EAAmBC,OAAnB,QAAkC,OAAlC;AACA,SAASC,aAAT,QAA8B,0BAA9B;AACA,SAASC,aAAT,EAAwBC,UAAxB,QAA0C,4BAA1C;AAKA,OAAO,SAASC,iBAAT,CAA2BC,KAA3B,EAA4D;AAAA,MAAjCA,KAAiC;AAAjCA,SAAiC,GAAzB,EAARA;AAAiC;;AACjE,MAAM;AACJC,UADI;AAEJC,eAFI;AAGJC,qBAHI;AAIJC,mBAJI;AAKJC,sBALI;AAMJC,iBANI;AAOJC,iBAPI;AAQJC,mBARI;AASJC,kBATI;AAUJC;AAVI,MAWFV,KAXJ;AAYA,MAAM;AAAEW;AAAF,MAAUf,aAAa,EAA7B;AAEA,MAAM,CAACgB,cAAD,EAAiBC,iBAAjB,IAAsCnB,QAAQ,EAApD;AACA,MAAMoB,MAAM,GAAGC,MAAM,CAACC,OAAtB;AACA,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBxB,QAAQ,CAAiBoB,MAAjB,CAAtC;AACA,MAAM,CAACK,UAAD,EAAaC,cAAb,IAA+B1B,QAAQ,CAAC,SAAS,CAAC,CAACoB,MAAZ,CAA7C;AACA,MAAMO,IAAI,GAAG;AACXpB,UADW;AAEXC,eAFW;AAGXC,qBAHW;AAIXC,mBAJW;AAKXC,sBALW;AAMXC,iBANW;AAOXC,iBAPW;AAQXC,mBARW;AASXC,kBATW;AAUXC;AAVW,GAAb;AAaAf,SAAO,CAAC,MAAM;AACZ;AACA,QAAIgB,GAAG,IAAIM,OAAPN,IAAkB,CAACC,cAAvB,EAAuC;AACrC,UAAIK,OAAO,CAACK,cAAZ,EAA4B;AAC1B,YAAMC,QAAQ,GAAG,IAAIP,OAAO,CAACM,cAAZ,CAA2BX,GAA3B,EAAgCU,IAAhC,CAAjB;AACAR,yBAAiB,CAACU,QAAD,CAAjBV;AACD;AANS,MASZ;;;AACA,QAAIF,GAAG,IAAIM,OAAPN,IAAkB,CAACM,OAAO,CAACK,cAA/B,EAA+C;AAC7CxB,gBAAU,CAAC,2EAAD,CAAVA,CAAwF0B,IAAxF1B,CAA6F,MAAM,CAAnG;AAEAD,mBAAa,CAAC,0EAAD,CAAbA,CACG2B,IADH3B,CACQ,MAAM;AACV,YAAIkB,MAAM,CAACC,OAAX,EAAoB;AAClB,cAAMS,SAAS,GAAGC,MAAM,CAACC,MAAPD,CAAcX,MAAM,CAACC,OAArBU,EAA8BT,OAA9BS,CAAlB;AACAR,oBAAU,CAACO,SAAD,CAAVP;;AAEA,cAAMK,SAAQ,GAAG,IAAIP,OAAO,CAACM,cAAZ,CAA2BX,GAA3B,EAAgCU,IAAhC,CAAjB;;AACAR,2BAAiB,CAACU,SAAD,CAAjBV;AACD;AARL,SAUGe,KAVH/B,CAUS,MAAM,CAVf;AAbU,MA0BZ;;;AACA,QAAI,CAACoB,OAAD,IAAY,CAACE,UAAjB,EAA6B;AAC3BC,oBAAc,CAAC,IAAD,CAAdA;AACAtB,gBAAU,CAAC,2EAAD,CAAVA,CAAwF0B,IAAxF1B,CAA6F,MAAM,CAAnG;AACAD,mBAAa,CAAC,0EAAD,CAAbA,CACG2B,IADH3B,CACQ,MAAM;AACV,YAAIkB,MAAM,CAACC,OAAX,EAAoB;AAClBE,oBAAU,CAACH,MAAM,CAACC,OAAR,CAAVE;AACD;AAJL,SAMGU,KANH/B,CAMS,MAAM,CANf;AA9BU,MAsCZ;;AAtCK,KAuCJ,CAACc,GAAD,EAAMQ,UAAN,EAAkBF,OAAlB,EAA2BL,cAA3B,CAvCI,CAAPjB;AAyCA,SAAO;AACLiB,kBADK;AAELC,qBAFK;AAGLG,WAAO,EAAEC;AAHJ,GAAP;AAKD","names":["useState","useMemo","useMapContext","requireScript","requireCss","useDrawingManager","props","isOpen","drawingMode","enableDrawingTool","enableCalculate","drawingToolOptions","markerOptions","circleOptions","polylineOptions","polygonOptions","rectangleOptions","map","drawingManager","setDrawingManager","libSDK","window","BMapLib","bMapLib","setBMapLib","loadMapLib","setLoadBMapLib","opts","DrawingManager","instance","then","newMapLib","Object","assign","catch"],"sources":["D:\\HB\\ReactProject\\22_3_8\\backboot\\node_modules\\@uiw\\react-baidu-map-drawing-manager\\src\\useDrawingManager.tsx"],"sourcesContent":["import { useState, useMemo } from 'react';\nimport { useMapContext } from '@uiw/react-baidu-map-map';\nimport { requireScript, requireCss } from '@uiw/react-baidu-map-utils';\nimport { DrawingManagerProps } from '.';\n\nexport interface UseDrawingManager extends DrawingManagerProps {}\n\nexport function useDrawingManager(props = {} as UseDrawingManager) {\n  const {\n    isOpen,\n    drawingMode,\n    enableDrawingTool,\n    enableCalculate,\n    drawingToolOptions,\n    markerOptions,\n    circleOptions,\n    polylineOptions,\n    polygonOptions,\n    rectangleOptions,\n  } = props;\n  const { map } = useMapContext();\n\n  const [drawingManager, setDrawingManager] = useState<BMapLib.DrawingManager>();\n  const libSDK = window.BMapLib;\n  const [bMapLib, setBMapLib] = useState<typeof BMapLib>(libSDK);\n  const [loadMapLib, setLoadBMapLib] = useState(false || !!libSDK);\n  const opts = {\n    isOpen,\n    drawingMode,\n    enableDrawingTool,\n    enableCalculate,\n    drawingToolOptions,\n    markerOptions,\n    circleOptions,\n    polylineOptions,\n    polygonOptions,\n    rectangleOptions,\n  } as BMap.DrawingManagerOptions;\n\n  useMemo(() => {\n    // 如果第一次加载，会执行下面的\n    if (map && bMapLib && !drawingManager) {\n      if (bMapLib.DrawingManager) {\n        const instance = new BMapLib.DrawingManager(map, opts);\n        setDrawingManager(instance);\n      }\n    }\n\n    // 如果 bMapLib 已经加载过，会执行下面的\n    if (map && bMapLib && !bMapLib.DrawingManager) {\n      requireCss('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css').then(() => {});\n\n      requireScript('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js')\n        .then(() => {\n          if (window.BMapLib) {\n            const newMapLib = Object.assign(window.BMapLib, bMapLib);\n            setBMapLib(newMapLib);\n\n            const instance = new BMapLib.DrawingManager(map, opts);\n            setDrawingManager(instance);\n          }\n        })\n        .catch(() => {});\n    }\n\n    // 如果第一次加载，会执行下面的\n    if (!bMapLib && !loadMapLib) {\n      setLoadBMapLib(true);\n      requireCss('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css').then(() => {});\n      requireScript('//api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js')\n        .then(() => {\n          if (window.BMapLib) {\n            setBMapLib(window.BMapLib);\n          }\n        })\n        .catch(() => {});\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map, loadMapLib, bMapLib, drawingManager]);\n\n  return {\n    drawingManager,\n    setDrawingManager,\n    BMapLib: bMapLib,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}